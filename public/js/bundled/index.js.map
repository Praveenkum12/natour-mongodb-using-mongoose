{"mappings":"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","sources":["<anon>","public/js/index.js","public/js/logIn.js","public/js/alert.js","public/js/logout.js","public/js/updateSettings.js","public/js/stripe.js","public/js/signup.js"],"sourcesContent":["require(\"@babel/polyfill\");\nvar $lRq1g$axios = require(\"axios\");\n\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\n\nconst $16587cf4a6943845$var$hideAlert = function() {\n    const el = document.querySelector(\".alert\");\n    el?.parentElement.removeChild(el);\n};\nconst $16587cf4a6943845$export$de026b00723010c1 = function(type, msg, time = 5) {\n    $16587cf4a6943845$var$hideAlert();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n    setTimeout($16587cf4a6943845$var$hideAlert, time * 1000);\n};\n\n\nconst $4bfa0851b457b669$export$596d806903d1f59e = async function(email, password) {\n    try {\n        const res = await (0, ($parcel$interopDefault($lRq1g$axios)))({\n            method: \"POST\",\n            url: \"/api/v1/users/login\",\n            data: {\n                email: email,\n                password: password\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $16587cf4a6943845$export$de026b00723010c1)(\"success\", \"Logged in succcessfully!!\");\n            window.setTimeout(function() {\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (err) {\n        (0, $16587cf4a6943845$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n\n\nconst $9b41890e71b0d1f7$export$a0973bcfe11b05c9 = async function() {\n    try {\n        await (0, ($parcel$interopDefault($lRq1g$axios)))(\"/api/v1/users/logout\");\n        // this helps to reload the server\n        location.reload(true);\n        location.assign(\"/\");\n    } catch (err) {\n        (0, $16587cf4a6943845$export$de026b00723010c1)(\"error\", \"Error on Logging out. Try again!\");\n    }\n};\n\n\n\n\nconst $3843a6bc3071435b$export$87d51fc9023e4534 = async function(data, type) {\n    try {\n        const url = type === \"password\" ? \"/api/v1/users/updateMyPassword\" : \"/api/v1/users/updateMe\";\n        const res = await (0, ($parcel$interopDefault($lRq1g$axios)))({\n            method: \"PATCH\",\n            url: url,\n            data: data\n        });\n        if (res.data.status === \"success\") {\n            (0, $16587cf4a6943845$export$de026b00723010c1)(\"success\", `${type.toUpperCase()} updated successfully!`);\n            location.assign(\"/me\");\n        }\n    } catch (err) {\n        (0, $16587cf4a6943845$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n\n\nconst $c6b38b6b1de4b63b$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    const stripe = Stripe(\"pk_test_51ORuzoSJChrrOJZcfGJUd3FLRQbWABXd50XJ8GmQvKjWWjnofU6QaSIbeO0YF7z640vAmVtUlwQyTXPbtzcS93VX0004XpYfVh\");\n    try {\n        //1)Get session from the server\n        const session = await (0, ($parcel$interopDefault($lRq1g$axios)))(`/api/v1/bookings/checkout-session/${tourId}`);\n        console.log(session);\n        //2)Create checkout form + charge credit card\n        await stripe.redirectToCheckout({\n            sessionId: session.data.session.id\n        });\n    } catch (err) {\n        console.log(\"Error \", err);\n        (0, $16587cf4a6943845$export$de026b00723010c1)(\"error\", err);\n    }\n};\n\n\n\n\nconst $4844f878eaf6b469$export$7200a869094fec36 = async function(name, email, password, passwordConfirm) {\n    try {\n        const res = await (0, ($parcel$interopDefault($lRq1g$axios)))({\n            method: \"POST\",\n            url: \"/api/v1/users/signup\",\n            data: {\n                name: name,\n                email: email,\n                password: password,\n                passwordConfirm: passwordConfirm\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $16587cf4a6943845$export$de026b00723010c1)(\"success\", \"Sign up succcessfully!!\");\n            window.setTimeout(function() {\n                location.assign(\"/\");\n            }, 100);\n        }\n    } catch (err) {\n        (0, $16587cf4a6943845$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n\ndocument.querySelector(\".form-login\")?.addEventListener(\"submit\", function(e) {\n    e.preventDefault();\n    const email = document.querySelector(\"#email\").value;\n    const password = document.querySelector(\"#password\").value;\n    (0, $4bfa0851b457b669$export$596d806903d1f59e)(email, password);\n});\ndocument.querySelector(\".form-signup\")?.addEventListener(\"submit\", function(e) {\n    e.preventDefault();\n    const username = document.querySelector(\"#username\").value;\n    const email = document.querySelector(\"#email\").value;\n    const password = document.querySelector(\"#password\").value;\n    const confirmPassword = document.querySelector(\"#confirm-password\").value;\n    (0, $4844f878eaf6b469$export$7200a869094fec36)(username, email, password, confirmPassword);\n});\ndocument.querySelector(\"#log-out\")?.addEventListener(\"click\", function() {\n    (0, $9b41890e71b0d1f7$export$a0973bcfe11b05c9)();\n});\ndocument.querySelector(\".form-user-data\")?.addEventListener(\"submit\", function(e) {\n    e.preventDefault();\n    // for multipart form data\n    const form = new FormData();\n    form.append(\"name\", document.querySelector(\"#name\").value);\n    form.append(\"email\", document.querySelector(\"#email\").value);\n    form.append(\"photo\", document.querySelector(\"#photo\").files[0]);\n    (0, $3843a6bc3071435b$export$87d51fc9023e4534)(form, \"data\");\n});\ndocument.querySelector(\".form-user-password\")?.addEventListener(\"submit\", function(e) {\n    e.preventDefault();\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\n    const passwordCurrent = document.querySelector(\"#password-current\").value;\n    const password = document.querySelector(\"#password\").value;\n    const passwordConfirm = document.querySelector(\"#password-confirm\").value;\n    (0, $3843a6bc3071435b$export$87d51fc9023e4534)({\n        passwordCurrent: passwordCurrent,\n        password: password,\n        passwordConfirm: passwordConfirm\n    }, \"password\");\n    document.querySelector(\".btn--save-password\").textContent = \"Save Password\";\n    document.querySelector(\"#password-current\").value = \"\";\n    document.querySelector(\"#password\").value = \"\";\n    document.querySelector(\"#password-confirm\").value = \"\";\n});\ndocument.getElementById(\"book-tour\")?.addEventListener(\"click\", function(e) {\n    e.target.textContent = \"Processing...\";\n    const { tourId: tourId } = e.target.dataset;\n    (0, $c6b38b6b1de4b63b$export$8d5bdbf26681c0c2)(tourId);\n});\nconst $fa79da8abd1c9dd8$var$alertMessage = document.querySelector(\"body\").dataset.alert;\nif (alert) (0, $16587cf4a6943845$export$de026b00723010c1)(\"sucsess\", $fa79da8abd1c9dd8$var$alertMessage, 20);\n\n\n//# sourceMappingURL=index.js.map\n","import '@babel/polyfill';\r\nimport { login } from './logIn';\r\nimport { logout } from './logout';\r\nimport { updateSetting } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\nimport { signup } from './signup';\r\nimport { showAlert } from './alert';\r\n\r\ndocument.querySelector('.form-login')?.addEventListener('submit', function (e) {\r\n  e.preventDefault();\r\n  const email = document.querySelector('#email').value;\r\n  const password = document.querySelector('#password').value;\r\n  login(email, password);\r\n});\r\n\r\ndocument\r\n  .querySelector('.form-signup')\r\n  ?.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    const username = document.querySelector('#username').value;\r\n    const email = document.querySelector('#email').value;\r\n    const password = document.querySelector('#password').value;\r\n    const confirmPassword = document.querySelector('#confirm-password').value;\r\n    signup(username, email, password, confirmPassword);\r\n  });\r\n\r\ndocument.querySelector('#log-out')?.addEventListener('click', function () {\r\n  logout();\r\n});\r\n\r\ndocument\r\n  .querySelector('.form-user-data')\r\n  ?.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    // for multipart form data\r\n    const form = new FormData();\r\n    form.append('name', document.querySelector('#name').value);\r\n    form.append('email', document.querySelector('#email').value);\r\n    form.append('photo', document.querySelector('#photo').files[0]);\r\n\r\n    updateSetting(form, 'data');\r\n  });\r\n\r\ndocument\r\n  .querySelector('.form-user-password')\r\n  ?.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n    const passwordCurrent = document.querySelector('#password-current').value;\r\n    const password = document.querySelector('#password').value;\r\n    const passwordConfirm = document.querySelector('#password-confirm').value;\r\n    updateSetting({ passwordCurrent, password, passwordConfirm }, 'password');\r\n    document.querySelector('.btn--save-password').textContent = 'Save Password';\r\n    document.querySelector('#password-current').value = '';\r\n    document.querySelector('#password').value = '';\r\n    document.querySelector('#password-confirm').value = '';\r\n  });\r\n\r\ndocument.getElementById('book-tour')?.addEventListener('click', function (e) {\r\n  e.target.textContent = 'Processing...';\r\n  const { tourId } = e.target.dataset;\r\n  bookTour(tourId);\r\n});\r\n\r\nconst alertMessage = document.querySelector('body').dataset.alert;\r\nif (alert) showAlert('sucsess', alertMessage, 20);\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const login = async function (email, password) {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in succcessfully!!');\r\n      window.setTimeout(function () {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","const hideAlert = function () {\r\n  const el = document.querySelector('.alert');\r\n  el?.parentElement.removeChild(el);\r\n};\r\n\r\nexport const showAlert = function (type, msg, time = 5) {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  setTimeout(hideAlert, time * 1000);\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const logout = async function () {\r\n  try {\r\n    await axios('/api/v1/users/logout');\r\n    // this helps to reload the server\r\n    location.reload(true);\r\n    location.assign('/');\r\n  } catch (err) {\r\n    showAlert('error', 'Error on Logging out. Try again!');\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const updateSetting = async function (data, type) {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\r\n      location.assign('/me');\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\n// <script src=\"http://js.stripe.com/v3/\"></script> --- make sure to include in the head\r\n\r\nexport const bookTour = async (tourId) => {\r\n  const stripe = Stripe(\r\n    'pk_test_51ORuzoSJChrrOJZcfGJUd3FLRQbWABXd50XJ8GmQvKjWWjnofU6QaSIbeO0YF7z640vAmVtUlwQyTXPbtzcS93VX0004XpYfVh'\r\n  );\r\n  try {\r\n    //1)Get session from the server\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n    console.log(session);\r\n\r\n    //2)Create checkout form + charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    console.log('Error ', err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const signup = async function (name, email, password, passwordConfirm) {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/signup',\r\n      data: {\r\n        name,\r\n        email,\r\n        password,\r\n        passwordConfirm,\r\n      },\r\n    });\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Sign up succcessfully!!');\r\n      window.setTimeout(function () {\r\n        location.assign('/');\r\n      }, 100);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n"],"names":["require","$lRq1g$axios","$parcel$interopDefault","a","__esModule","default","$16587cf4a6943845$var$hideAlert","el","document","querySelector","parentElement","removeChild","$16587cf4a6943845$export$de026b00723010c1","type","msg","time","markup","insertAdjacentHTML","setTimeout","$4bfa0851b457b669$export$596d806903d1f59e","email","password","res","method","url","data","status","window","location","assign","err","response","message","$9b41890e71b0d1f7$export$a0973bcfe11b05c9","reload","$3843a6bc3071435b$export$87d51fc9023e4534","toUpperCase","$c6b38b6b1de4b63b$export$8d5bdbf26681c0c2","tourId","stripe","Stripe","session","console","log","redirectToCheckout","sessionId","id","$4844f878eaf6b469$export$7200a869094fec36","name","passwordConfirm","addEventListener","e","preventDefault","value","username","form","FormData","append","files","textContent","passwordCurrent","getElementById","target","dataset","$fa79da8abd1c9dd8$var$alertMessage","alert"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}